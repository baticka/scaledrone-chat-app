(()=>{const e=document.querySelector(".message-container"),n=document.querySelector(".members-list"),o=(document.querySelector("form"),document.querySelector(".message-form__button"));let t=document.querySelector(".message-form__input"),a=[],r=["Donald","Mickey","Minnie","Pluto","Daisy","Goofy","Scrooge","Moby"];const s=()=>Math.floor(Math.random()*element),c=new Scaledrone('USZQvKl3q84qn0Yy',{data:{name:(element=r.length,`${r[s()]} ${["Duck","Mouse","Frog","McQuack","Goof","McDuck","Vanderquack","Pistoles"][s()]}`),color:(element=256,`rgb(${s()}, ${s()}, ${s()})`)}});c.on("open",(e=>{e&&alert("Something went wrong, try again");const n=c.subscribe("observable-room");n.on("open",(function(e){e&&alert("Something went wrong, try again")})),n.on("members",(e=>{a=e,l()})),n.on("message",(e=>{i(e.data,e.member)})),n.on("member_join",(e=>{a.push(e),l()})),n.on("member_leave",(({id:e})=>{const n=a.findIndex((n=>n.id===e));a.splice(n,1),l()}))})),o.addEventListener("click",(()=>{new RegExp("^[^S.*$0-9A-Za-z]+$").test(t.value)?alert("Type something, blank message is no fun"):(t.value?c.publish({room:"observable-room",message:t.value}):alert("Type something, blank message is no fun"),t.value="")}));const l=()=>{n.innerHTML="",a.forEach((e=>n.appendChild(m(e))))},m=e=>{const n=document.createElement("div");return n.innerText=e.clientData.name,n.style.color=e.clientData.color,n},i=(n,o)=>{const t=m(o),a=document.createElement("div"),r=document.createTextNode(n),s=document.createElement("div");a.append(r),s.append(t,a),e.appendChild(s),(()=>{let e=document.querySelectorAll(".message-container > div"),n=document.querySelectorAll(".message-container > div > div:nth-child(1)");for(let o=0;o<n.length;o++){const t=e[o],a=n[o];n[o].innerText&&(a.innerHTML==c.args[1].data.name?t.classList.add("message-end"):t.classList.add("message-start"))}})()};})();